version: '2.3'
services:
  project05-nvidia-conda01:
     build: .
     image: project05-nvidia-conda01:v1
     container_name: project05-container-nvidia-conda01
     runtime: nvidia
     volumes:
        - /dev:/dev
        - .:/awl/app
        - ${XSOCK}:${XSOCK}
        - ${XAUTH}:${XAUTH}
     ports:
        - "554:554"
        - "5000:5000"
        - "7000:7001"
     restart: always
     env_file:
        - .env
     environment:
        - DISPLAY
        - QT_X11_NO_MITSHM=1
     links:
        - mongodb
     depends_on:
        - mongodb

  mongodb:
     image: mongo:4.0
     container_name: "mongodb"
     restart: always
     environment:
        - MONGO_DATA_DIR=/data/db
#        - MONGO_INITDB_ROOT_USERNAME=root
#        - MONGO_INITDB_ROOT_PASSWORD=123456
        - MONGO_LOG_DIR=/dev/null
     volumes:
        - ./data/db:/data/db
     command: mongod --smallfiles --logpath=/dev/null
